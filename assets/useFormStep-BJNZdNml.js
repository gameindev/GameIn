import{f as x,u as C,j as b,B as D,g as K,v as Y,w as Z,z as q,c as G,y as J,x as Q,D as W,k as I,l as ss,a as w,X as es,Y as A,Z as ts,I as rs}from"./index-D9oEtHeb.js";import{u as as,a as os}from"./useApi-HEZO75xY.js";import{c as ns}from"./create-safe-context-BzETH9ei.js";import{g as is}from"./get-auto-contrast-value-Da6zqqWm.js";import{u as cs}from"./FormField-pkCODe5l.js";import{o as ls}from"./index.esm-DgqbvREp.js";import{f as us,s as B}from"./index-Cb_V-kUK.js";const[ms,L]=ns("Progress.Root component was not found in tree");var P={root:"m_db6d6462",section:"m_2242eb65","stripes-animation":"m_81a374bd",label:"m_91e40b74"};const ps={},F=x((s,e)=>{const{classNames:r,className:o,style:i,styles:t,vars:d,...a}=C("ProgressLabel",ps,s),n=L();return b.jsx(D,{ref:e,...n.getStyles("label",{className:o,style:i,classNames:r,styles:t}),...a})});F.classes=P;F.displayName="@mantine/core/ProgressLabel";const ds={},gs=Y((s,{size:e,radius:r,transitionDuration:o})=>({root:{"--progress-size":q(e,"progress-size"),"--progress-radius":r===void 0?void 0:Z(r),"--progress-transition-duration":typeof o=="number"?`${o}ms`:void 0}})),R=x((s,e)=>{const r=C("ProgressRoot",ds,s),{classNames:o,className:i,style:t,styles:d,unstyled:a,vars:n,autoContrast:c,transitionDuration:g,...l}=r,u=K({name:"Progress",classes:P,props:r,className:i,style:t,classNames:o,styles:d,unstyled:a,vars:n,varsResolver:gs});return b.jsx(ms,{value:{getStyles:u,autoContrast:c},children:b.jsx(D,{ref:e,...u("root"),...l})})});R.classes=P;R.displayName="@mantine/core/ProgressRoot";const fs={withAria:!0},E=x((s,e)=>{const{classNames:r,className:o,style:i,styles:t,vars:d,value:a,withAria:n,color:c,striped:g,animated:l,mod:u,...v}=C("ProgressSection",fs,s),f=L(),y=G(),h=n?{role:"progressbar","aria-valuemax":100,"aria-valuemin":0,"aria-valuenow":a,"aria-valuetext":`${a}%`}:{};return b.jsx(D,{ref:e,...f.getStyles("section",{className:o,classNames:r,styles:t,style:i}),...v,...h,mod:[{striped:g||l,animated:l},u],__vars:{"--progress-section-width":`${a}%`,"--progress-section-color":Q(c,y),"--progress-label-color":is(f.autoContrast,y)?J({color:c,theme:y,autoContrast:f.autoContrast}):void 0}})});E.classes=P;E.displayName="@mantine/core/ProgressSection";const ys={},j=x((s,e)=>{const r=C("Progress",ys,s),{value:o,classNames:i,styles:t,vars:d,color:a,striped:n,animated:c,"aria-label":g,...l}=r,{resolvedClassNames:u,resolvedStyles:v}=as({classNames:i,styles:t,props:r});return b.jsx(R,{ref:e,classNames:u,styles:v,vars:d,...l,children:b.jsx(E,{value:o,color:a,striped:n,animated:c,"aria-label":g})})});j.classes=P;j.displayName="@mantine/core/Progress";j.Section=E;j.Root=R;j.Label=F;const Ss=async(s,e)=>{var i;console.log("formData",s);const r={username:s.username,email:s.email,password:s.password,userType:((i=s.role)==null?void 0:i.toUpperCase())||"USER",dateOfBirth:us(s.dob),isActive:!0,isVerified:!1},o={"Content-Type":"application/json","X-Captcha-Token":s.captcha||""};try{const{data:t}=await e(W.USERS.CREATE,r,o);return{userData:t,error:null}}catch(t){return{userData:null,error:(t==null?void 0:t.message)||"Something went wrong"}}};function Cs({formId:s,defaultValues:e,schema:r,onNext:o,onPrev:i,onSubmit:t,isFinalStep:d=!1}){const a=I(),n=ss(m=>{var p;return(p=m.multiStepForm.forms)==null?void 0:p[s]}),c=w.useMemo(()=>(n==null?void 0:n.formData)||{},[n==null?void 0:n.formData]),[g,l]=w.useState(!1);w.useEffect(()=>{n||a(es({formId:s,initialData:e}))},[a,s,n,e]);const{register:u,control:v,formState:{errors:f},trigger:y,getValues:h,setValue:N,watch:_,setFocus:O,handleSubmit:T}=cs({resolver:r?ls(r):void 0,mode:"onSubmit",defaultValues:{...e,...c}}),k=_();w.useEffect(()=>{Object.entries(e).forEach(([m])=>{c[m]!==void 0&&N(m,c[m])})},[c,e,N]);const $=async()=>{if(!await y(Object.keys(e))){const S=Object.keys(f)[0];O(S);return}const p=h();if(a(A({formId:s,data:p})),d&&t){const S={...c,...p};return t(S)}o==null||o()},V=()=>{a(A({formId:s,data:h()})),i==null||i()},{post:H}=os(),M=T(t?async m=>{const p=Object.fromEntries(Object.entries(m).filter(([X])=>Object.keys(e).includes(X)));a(A({formId:s,data:p}));const S={...c,...p};l(!0);const{userData:z,error:U}=await Ss(S,H);if(l(!1),U){B("Registration failed",U,"red");return}if(z)return B("Registration successful","Please verify your mail id"),localStorage.removeItem("persist:multiStepForm"),a(ts({formId:s})),a(rs(z)),t(S)}:$);return{register:u,control:v,errors:f,formValues:k,setValue:N,getValues:h,watch:_,trigger:y,setFocus:O,handleNextStep:$,handlePrevStep:V,handleSubmit:M,isSubmitting:g}}export{j as P,Cs as u};
