import{f as w,u as x,j as v,B as N,e as H,w as K,y as M,A as X,c as Y,x as Z,v as q,k as G,l as J,r as $,Y as A,Z as Q,S as W}from"./index-DnhGP-h6.js";import{u as ss}from"./authSlice-B0mofB6N.js";import{c as es}from"./create-safe-context-D7AAtHN4.js";import{g as ts}from"./get-auto-contrast-value-Da6zqqWm.js";import{f as rs,A as os,u as as,b as ns,s as U,o as is}from"./FormField-CDLEbEWJ.js";const[cs,V]=es("Progress.Root component was not found in tree");var h={root:"m_db6d6462",section:"m_2242eb65","stripes-animation":"m_81a374bd",label:"m_91e40b74"};const ls={},E=w((s,n)=>{const{classNames:e,className:t,style:o,styles:a,vars:i,...r}=x("ProgressLabel",ls,s),c=V();return v.jsx(N,{ref:n,...c.getStyles("label",{className:t,style:o,classNames:e,styles:a}),...r})});E.classes=h;E.displayName="@mantine/core/ProgressLabel";const us={},ms=K((s,{size:n,radius:e,transitionDuration:t})=>({root:{"--progress-size":X(n,"progress-size"),"--progress-radius":e===void 0?void 0:M(e),"--progress-transition-duration":typeof t=="number"?`${t}ms`:void 0}})),C=w((s,n)=>{const e=x("ProgressRoot",us,s),{classNames:t,className:o,style:a,styles:i,unstyled:r,vars:c,autoContrast:l,transitionDuration:f,...m}=e,u=H({name:"Progress",classes:h,props:e,className:o,style:a,classNames:t,styles:i,unstyled:r,vars:c,varsResolver:ms});return v.jsx(cs,{value:{getStyles:u,autoContrast:l},children:v.jsx(N,{ref:n,...u("root"),...m})})});C.classes=h;C.displayName="@mantine/core/ProgressRoot";const ps={withAria:!0},R=w((s,n)=>{const{classNames:e,className:t,style:o,styles:a,vars:i,value:r,withAria:c,color:l,striped:f,animated:m,mod:u,...y}=x("ProgressSection",ps,s),S=V(),g=Y(),j=c?{role:"progressbar","aria-valuemax":100,"aria-valuemin":0,"aria-valuenow":r,"aria-valuetext":`${r}%`}:{};return v.jsx(N,{ref:n,...S.getStyles("section",{className:t,classNames:e,styles:a,style:o}),...y,...j,mod:[{striped:f||m,animated:m},u],__vars:{"--progress-section-width":`${r}%`,"--progress-section-color":q(l,g),"--progress-label-color":ts(S.autoContrast,g)?Z({color:l,theme:g,autoContrast:S.autoContrast}):void 0}})});R.classes=h;R.displayName="@mantine/core/ProgressSection";const ds={},P=w((s,n)=>{const e=x("Progress",ds,s),{value:t,classNames:o,styles:a,vars:i,color:r,striped:c,animated:l,"aria-label":f,...m}=e,{resolvedClassNames:u,resolvedStyles:y}=ss({classNames:o,styles:a,props:e});return v.jsx(C,{ref:n,classNames:u,styles:y,vars:i,...m,children:v.jsx(R,{value:t,color:r,striped:c,animated:l,"aria-label":f})})});P.classes=h;P.displayName="@mantine/core/Progress";P.Section=R;P.Root=C;P.Label=E;const gs=async(s,n)=>{var o;const e={username:s.username,email:s.email,password:s.password,userType:((o=s.role)==null?void 0:o.toUpperCase())||"USER",dateOfBirth:rs(s.dob),isActive:!0,isVerified:!1},t={"Content-Type":"application/json","X-Captcha-Token":s.captcha||""};try{const{data:a}=await n(os.USERS.CREATE,e,t);return{userData:a,error:null}}catch(a){return{userData:null,error:(a==null?void 0:a.message)||"Something went wrong"}}};function hs({defaultValues:s,schema:n,onNext:e,onPrev:t,onSubmit:o,isFinalStep:a=!1}){const i=G(),r=J(p=>{var d;return((d=p.multiStepForm)==null?void 0:d.formData)||{}}),[c,l]=$.useState(!1),{register:f,control:m,formState:{errors:u},trigger:y,getValues:S,setValue:g,watch:j,setFocus:F,handleSubmit:_}=as({resolver:n?is(n):void 0,mode:"onSubmit",defaultValues:{...s,...r}}),B=j();$.useEffect(()=>{Object.entries(s).forEach(([p])=>{r[p]!==void 0&&g(p,r[p])})},[r,s,g]);const D=async()=>{if(!await y(Object.keys(s))){const b=Object.keys(u)[0];F(b);return}const d=S();if(i(A(d)),a&&o){const b={...r,...d};return o(b)}e==null||e()},L=()=>{i(A(S())),t==null||t()},{post:k}=ns(),z=_(o?async p=>{const d=Object.fromEntries(Object.entries(p).filter(([I])=>Object.keys(s).includes(I)));i(A(d));const b={...r,...d};l(!0);const{userData:O,error:T}=await gs(b,k);if(l(!1),T){U("Registration failed",T,"red");return}if(O)return U("Registration successful","Please verify your mail id"),localStorage.removeItem("persist:multiStepForm"),i(Q()),i(W(O)),o(b)}:D);return{register:f,control:m,errors:u,formValues:B,setValue:g,watch:j,trigger:y,setFocus:F,handleNextStep:D,handlePrevStep:L,handleSubmit:z,isSubmitting:c}}export{P,hs as u};
